<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="izlyforever">
        <link rel="canonical" href="https://izlyforever.github.io/cpplibforCP/cn/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>CN - izlyforever</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/rainbow.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">izlyforever</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Home <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href=".." class="dropdown-item">Introduction</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Math <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../math/basic/" class="dropdown-item">basic</a>
</li>
                                    
<li>
    <a href="../math/primary/" class="dropdown-item">primary</a>
</li>
                                    
<li>
    <a href="../math/numberTheory/" class="dropdown-item">numberTheory</a>
</li>
                                    
<li>
    <a href="../math/mod/" class="dropdown-item">mod</a>
</li>
                                    
<li>
    <a href="../math/poly/" class="dropdown-item">poly</a>
</li>
                                    
<li>
    <a href="../math/mixed/" class="dropdown-item">mixed</a>
</li>
                                    
<li>
    <a href="../math/geometry/" class="dropdown-item">geometry</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../dataStructure/" class="nav-link">Data Structure</a>
                            </li>
                            <li class="navitem">
                                <a href="../graph/" class="nav-link">Graph Theory</a>
                            </li>
                            <li class="navitem">
                                <a href="../string/" class="nav-link">String</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">CN</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../string/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" class="nav-link disabled">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/izlyforever/cpplibforCP/edit/master/docs/cn.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#_1" class="nav-link">文档</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#_2" class="nav-link">思想</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_3" class="nav-link">数学</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_8" class="nav-link">图论</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_9" class="nav-link">字符串</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_10" class="nav-link">数据结构</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p>此文档仅为补充，这里就放一个大致目录和一些核心内容的说明（有些英文说太麻烦），可以在我的 <a href="https://www.cnblogs.com/izlyforever/p/templateOfCpp.html">cnblog</a> 里找到很多核心代码的原理</p>
<h1 id="_1">文档</h1>
<ul>
<li>使用：编译器需支持 C++17，强烈建议开启 O2 优化</li>
<li>分类：数学，数据结构，字符串，图论，几何，杂类</li>
<li>约定：以 S 为后缀的算法都是 慢且简单 的算法，？表示暂未实现。</li>
<li>下标：默认以 0 开头，目前只有<strong>树状数组和一些树算法</strong>为了方便起见从 1 开头。</li>
</ul>
<h2 id="_2">思想</h2>
<ul>
<li>动态规划</li>
<li>二分</li>
<li>倍增</li>
<li>分块</li>
<li>分治</li>
<li><a href="(https://codeforces.com/blog/entry/58316)">水涨船高</a></li>
<li>决策单调性优化</li>
<li>Meet in Middle</li>
<li>Small to Large</li>
</ul>
<h2 id="_3">数学</h2>
<h3 id="primaryhpp">基础模块：primary.hpp</h3>
<ul>
<li>模快速幂</li>
<li>向上取整和向下取整</li>
<li>int128 读写（快读，int, long long 也可以使用）</li>
<li>二进制快速 gcd，拓展 gcd</li>
<li>中国剩余定理 CRT</li>
<li>常规二项式系数和模二项式系数（单例）</li>
<li>Lagrange 插值</li>
<li>模自然数方幂和 <script type="math/tex">O(k)</script> 算法</li>
<li>模 <script type="math/tex">N \times N</script> 矩阵乘法类（缓存优化）</li>
<li>MEX（集合中不出现的最小的自然数）</li>
<li>快速排序（没带随机选择，别用）</li>
<li>预处理最小素因子</li>
<li>BerlekampMassey（用来找最短递推公式）</li>
</ul>
<h3 id="modhpp">mod.hpp</h3>
<ul>
<li>MInt: 这个是类模板</li>
<li>ModInt</li>
<li>ModLL</li>
</ul>
<h3 id="ffthpp">FFT.hpp</h3>
<h3 id="ntthpp">NTT.hpp</h3>
<h3 id="fmthpp">FMT.hpp</h3>
<p>快速 Mobius 变换，叫这个名字是因为跟数论函数的 Mobius 变换形式上一致</p>
<h3 id="numbertheoryhpp">初等数论：numberTheory.hpp</h3>
<ul>
<li>快速 <script type="math/tex">O(n \log \log n)</script> 素数筛和慢速线性筛</li>
<li>快速计算 <script type="math/tex">\pi(x)</script>
</li>
<li>快速计算第 n 个素数（从 1 开始标号，p[1] = 2，p[0] 无意义）</li>
<li>Euler 线性筛</li>
<li>Mobius 线性筛</li>
<li>拓展欧拉定理（结论十分简单，证明需要分解素因式）</li>
<li>min_25 筛 <script type="math/tex">O(n^{\frac{2}{3}})</script> 算法求 Euler 函数前缀和，Mobius（绝对值）前缀和（内含 整除分块）</li>
<li>最小素因子线性筛</li>
<li>预处理素因子个数（算重/不算重）</li>
<li>素因子分解（算重/不算重）</li>
<li>求原根</li>
<li>大素数 Miller-Rabin 概率判别法</li>
<li>Pollard-Pho 大整数最大最小素因子分解</li>
<li>模素数取 log（BabyStepGaintStep）</li>
<li>模素数开根号 <script type="math/tex">O(log^2 p)</script>
</li>
<li>模素数开根号 <script type="math/tex">O(log p)</script> 的 Cipolla 算法</li>
<li>模偶素数幂开根号？</li>
<li>模奇素数幂开根号？</li>
<li>模任意数开根号（先因式分解，看作模素数方开根号，再 CRT 整合）？</li>
</ul>
<h3 id="bigint"><a href="https://github.com/izlyforever/BigInt">BigInt</a></h3>
<h3 id="_4">杂类</h3>
<ul>
<li>快速暴力 <script type="math/tex">n</script> 个集合中选 <script type="math/tex">k</script> 个，二进制为 1 的表示选择</li>
<li>KnuthShuffle</li>
<li>uniformChoose</li>
<li>Fibonacci 数列</li>
<li>floorSum：<script type="math/tex">\displaystyle \sum_{i = 0}^{n - 1} \lfloor \frac{a \cdot i + b}{m} \rfloor</script>
</li>
<li>sumNum：<script type="math/tex">\displaystyle \sum_{\sum c_i x_i = m} \frac{(\sum x_i)!}{\prod (x_i !)}</script>
</li>
<li>decInc: 每次可选择 n 减一 或 m 加一，使得 m 是 n 的倍数的最小次数</li>
<li>Gauss 消元法浮点数版</li>
<li>模 Gauss 消元法</li>
<li>线性规划之单纯形算法</li>
<li>任意模数多项式乘法 <script type="math/tex">O(n^{\log_2 3})</script> 的 Karatsuba 算法（包括并行版）</li>
<li>线性规划</li>
<li>FirstInRange：求最小的 <script type="math/tex">x</script> 使得 <script type="math/tex">l \leq a x \mod m \leq r</script>。类似 exgcd 的处理：求最小非负整数 <script type="math/tex">x</script> 使得 <script type="math/tex">l \leq ax - m y \leq r</script> 等价于 <script type="math/tex">l \leq (az - m)y - a(yz - x) \leq r</script>，注意到我们要始终保持 <script type="math/tex">a < m</script>，因此当 <script type="math/tex">2a > m</script> 时需要特判一下。转化成 <script type="math/tex">m - r \leq (m - a) x - m(x - y - 1) \leq m - l</script>
</li>
</ul>
<h4 id="knuthshuffle-uniformchoose">KnuthShuffle 和 uniformChoose 原理</h4>
<p>我们从后往前搞(<script type="math/tex">a[x] = x</script>)，假设当前要处理 <script type="math/tex">i</script> 位置，那么 <script type="math/tex">i</script> 位置前的位置不可能有交换的情况，即不可能 <script type="math/tex">j < k \leq i</script>, <script type="math/tex">a[j] = k</script> 或者 <script type="math/tex">a[k] = j</script>, 这是因为一但某个位置被换到后面之后就不会再变化了。</p>
<p>注意到上面这一点，就可以发现 <script type="math/tex">i</script> 后面的每个位置每个数出现的概率均等，且对于 <script type="math/tex">j \leq i</script>, <script type="math/tex">a[j] = j</script> 的概率为 <script type="math/tex">\frac{i}{n}</script>，为 <script type="math/tex">i + 1, i + 2, \cdots, n</script> 的概率为 <script type="math/tex">\frac{1}{n}</script>
</p>
<p>所以 <script type="math/tex">n</script> 步之后所有位置概率都为 <script type="math/tex">\frac{1}{n}</script>
</p>
<p>根据上述推理，我们在 <script type="math/tex">n</script> 个数中等概率的选取不同的 m 个数，显然只需要搞 <script type="math/tex">m</script> 步，后面的 <script type="math/tex">m</script> 个数为答案。然后默认 <script type="math/tex">a[i] = i</script>，所以用一个 map 保存所有 <script type="math/tex">a[i]</script> 不一定为 <script type="math/tex">i</script> 的位置的值</p>
<h3 id="ac">多项式（<a href="https://www.luogu.com.cn/training/3015#problems">多项式全家桶</a> 已全部 AC）</h3>
<ul>
<li>仅包含乘法的四大多项式底层基类分别为：PolyBaseNTT, PolyBaseMFT3(弃用，被后面两个淘汰了), PolyBaseMFT4, PolyBaseFFT</li>
<li>PolyBaseNTT：基于固定的 NTT-friendly（原根一般为 3）模数快速数论变化（看具体题目，一般为 998244353）</li>
<li>PolyBaseMFT3：基于三个固定的 NTT-friendly 且原根为 3 的三模数（469762049, 998244353, 1004535809），利用 crt 求解任意模数多项式乘法（已被淘汰，请勿使用）</li>
<li>PolyBaseMFT4：基于四个固定的 NTT-friendly 且原根为 3 的四模数（595591169, 645922817, 897581057, 998244353），利用 crt 求解任意模数多项式乘法</li>
<li>PolyBaseFFT：基于 FFT 求解任意模数多项式乘法（需要注意精度）</li>
<li>通过模板继承拓展得到全面的多项式类 Poly (加减乘除余，转置乘法，求导，积分，指数，对数，求逆，开方，一点求值，多点求值，快速幂模，内积，一个首一多项式的次方模 <script type="math/tex">x^n</script> 先取对数乘以次数再取指数得到，三角函数，反三角函数)，这个过程学到了很多东西</li>
<li>多项式静态函数：<script type="math/tex">O(n \log^2 n)</script> 计算 <script type="math/tex">\sum_{i = 1}^n \frac{a_i}{1 - b_i}</script>
</li>
<li>多项式静态函数：<script type="math/tex">O(k \log k \log n)</script> 求 <script type="math/tex">k</script> 阶常系数递推公式的第 <script type="math/tex">n</script> 项</li>
<li>多项式静态函数：模自然数方幂和 <script type="math/tex">O(k \log k)</script> 得到前 <script type="math/tex">k</script> 个答案</li>
<li>多项式静态函数：Lagrange 插值：先分治求 <script type="math/tex">g(x) = \prod(x - x_i)</script>，再求 <script type="math/tex">g'(x)</script> 在 <script type="math/tex">x</script> 处的多点求值，再分治即可。</li>
<li>求阶乘 <script type="math/tex">n! \mod p</script>：基于多点求值 <script type="math/tex">O(\sqrt{n} \log^2 n)</script> 求 <script type="math/tex">\sqrt{n}</script> 个点之后暴力</li>
<li>求阶乘 <script type="math/tex">n! \mod p</script>：min_25 用点求点 <script type="math/tex">O(\sqrt{n} \log n)</script> 求 <script type="math/tex">\sqrt{n}</script> 个点之后暴力</li>
</ul>
<blockquote>
<p>无运算的多项式底层基类：PolyBase（standard 在取余时，特别重要不可省略）</p>
</blockquote>
<h4 id="_5">使用准则</h4>
<ul>
<li>多项式项数 <script type="math/tex">N < 4 \cdot 10^6</script>
</li>
<li>
<script type="math/tex">M</script> 要是超了 int，那就只能用 ModLL 版本 4 模数 Poly</li>
<li>否则，要是 <script type="math/tex">M</script> 不固定就用使用 ModInt 的 FFT 版 Poly</li>
<li>否则，当 <script type="math/tex">M</script> 为固定的 NTT-friendly 素数时，使用 NTT 版 Poly</li>
<li>否则，使用 MInt 的 FFT 版 Poly</li>
</ul>
<h4 id="polys">极简版多项式模板（polyS）</h4>
<p>由于多项式模板一直扩展，动则 1000+ 行，实在有点搞，所以就搞了一个极简版的。</p>
<h4 id="4-fft">4 次 FFT 原理</h4>
<p>我们本来要求 <script type="math/tex">A \dot B</script>，然后我们把它拆成 <script type="math/tex">A = A_1 + 2^{d} A_2, B = B_1 + 2^d B_2</script>，那么 
<script type="math/tex; mode=display">
AB = A_1 B_1 + (A_1 B_2 + A_2 B_1) 2^d + A_2 B_2 2^{2d}
</script>
</p>
<p>于是我们只需计算 <script type="math/tex">(A_1 + i A_2)(B_1 + i B_2)</script> 和 <script type="math/tex">(A_1 + i A_2)(B_1 - i B_2)</script> 即可，但是注意到 <script type="math/tex">dft((B_1 + i B_2))[j] = \overline{dft((B_1 + i B_2))[n - j]}</script> 所以本来需要 5 次 FFT，现在只需要 4 次即可。</p>
<blockquote>
<p>其实本质上，我们可以只做 3.5 次 FFT，因为 2 次 dft 我们可以得到 <script type="math/tex">A_1, A_2, B_1, B_2</script> 的 dft 值，然后我们最后只需 3 次实数版 idft 即可（算作 1.5 次）！所以总的来说是 3.5 次。但是实现的时候也没办法搞 0.5 次，可惜。</p>
</blockquote>
<h4 id="min_25">min_25 用点求点原理（其实可以用下降幂更简洁的处理）</h4>
<p>学习资料：<a href="https://www.cnblogs.com/zzqsblog/p/8408691.html">zzqsblog</a>, <a href="https://www.cnblogs.com/bztMinamoto/p/10661226.html">bztMinamoto</a></p>
<p>我们令 <script type="math/tex">s = \sqrt{n}</script> 然后 <script type="math/tex">\displaystyle g_{s}(x) = \sum_{i = 1}^{s}(x + i)</script>，我们想要得到 <script type="math/tex">g_s(0), g_s(s), \cdots g_s((s - 1)s)</script> 的值。然后 <script type="math/tex">n! = \prod_{i = 0}^{s - 1} g_s(i s) \cdot \prod_{i = s^2 + 1}^n i</script>
</p>
<p>现在假设我们已经得到了</p>
<p>
<script type="math/tex; mode=display">
g_d(0), g_d(s), \cdots g_d(d s)
</script>
</p>
<blockquote>
<p>一个 <script type="math/tex">d</script> 次多项式由它在 <script type="math/tex">d + 1</script> 个不同点的取值唯一决定（多于 d + 1 个点也可以）</p>
</blockquote>
<ol>
<li>我们如何求</li>
</ol>
<p>
<script type="math/tex; mode=display">
g_{d + 1}(0), g_{d + 1}(s), \cdots g_{d + 1}((d + 1) s)
</script>
</p>
<p>注意到 <script type="math/tex">g_{d + 1}(x) = g_{d}(x) \cdot (x + d + 1)</script> 即可 <script type="math/tex">O(d)</script> 计算出 前 <script type="math/tex">d + 1</script> 个，最后一个直接暴力计算即可。</p>
<ol>
<li>我们如何求</li>
</ol>
<p>
<script type="math/tex; mode=display">
g_{2d}(0), g_{2d}(s), \cdots g_{2d}(2d s)
</script>
</p>
<p>同样我们注意到 <script type="math/tex">g_{2d}(x) = g_{d}(x) \cdot g_d(x + d)</script> 如果我们设 <script type="math/tex">h(i) = g_d(i s)</script>，（那么很关键的一点 <script type="math/tex">g_d(is + d) = g((d / s + i) s = h(d / s + i)</script>，卧槽， <script type="math/tex">d / s</script> 在模 p 意义下得到就可以了，而且肯定大于 d，否则矛盾！）那么问题就转化成如何根据一个 <script type="math/tex">d</script> 次多项式的值：<script type="math/tex">h(0), h(1), \cdots, h(d)</script> 求</p>
<p>
<script type="math/tex; mode=display">
h(d + 0), \cdots h(d + d)
</script>
</p>
<p>以及 </p>
<p>
<script type="math/tex; mode=display">
h(d / s + 0), \cdots h(d / s + d)
</script>
</p>
<p>我们不妨对于任意的给定的 <script type="math/tex">k > d</script>，先求出</p>
<p>
<script type="math/tex; mode=display">
h(k + 0), h(k + 1), \cdots h(k + d) 
</script>
</p>
<p>注意到根据 Lagrange 插值多项式</p>
<p>
<script type="math/tex; mode=display">
\begin{aligned}
h(x) &= \sum_{i = 0}^{d} h(i) \prod_{j = 0, j \neq i}^{d} \frac{x - j}{i - j} \\ 
 &= \sum_{i = 0}^d (-1)^{d - i} h(i) \binom{x}{i} \binom{x - i - 1}{d - i} \\
 &=  \left(\prod_{i = x - d}^x i \right) \sum_{i = 0}^d \frac{h(i)}{i!(d - i)!(-1)^{d - i}} \cdot \frac{1}{(x - i)}
\end{aligned}
</script>
</p>
<p>注意到这里的卷积跟我们普通的卷积不一致，左边长度为 <script type="math/tex">d + 1</script> 的多项式乘以右边长度为 <script type="math/tex">2d + 1</script> 的多项式，然后次数为 <script type="math/tex">d, \cdots 2d</script> 这 <script type="math/tex">d + 1</script> 位是有效的。</p>
<ol>
<li>不能写成除以阶乘的形式，因为 x 有可能很大。</li>
<li>为了保证 <script type="math/tex">d/s < 2 d</script>，我们需要使用 Wilson 定理即 <script type="math/tex">(p - 1)! = -1</script>
</li>
</ol>
<h4 id="fft">分治 FFT</h4>
<p>已知 <script type="math/tex">f_i = \sum_{j=1}^i f_{i-j} g_j</script> 和 <script type="math/tex">f_0</script> 求 <script type="math/tex">f</script>
</p>
<p>这个显然可以分治来做，其实用生成函数推理可知 <script type="math/tex">f = \frac{f_0}{1 - g}</script>
</p>
<h4 id="_6">下降幂与点值</h4>
<p>设 n 次多项式 <script type="math/tex">f(x) = \sum_{i = 0}^n b_i x^{\underline{i}}</script>，则</p>
<p>
<script type="math/tex; mode=display">
\frac{f(m)}{m!} = \sum_{i = 0}^m b_i \frac{1}{(m - i)!} \qquad 0 \leq m \leq n
</script>
</p>
<p>因此 <script type="math/tex">EGF(f) = b e^x</script>，反过来也一样  <script type="math/tex">b = EGF(f) e^{-x}</script>（注意这里可以简单的多点求值，可以求更多的点）</p>
<blockquote>
<p>下降幂与连续点值有 <script type="math/tex">O(n \log n)</script> 的转化。而普通多项式跟连续点值却没有，可以认为普通多项式要的连续其实是类似 FFT 那样的连续。但是注意到以连续点求连续点有 <script type="math/tex">O(n \log n)</script> 的做法</p>
</blockquote>
<h4 id="binom">Binom</h4>
<p>这里的单例很秀的一点就是用了 const 引用，但是却不妨碍我修改它的值！这样的好处：</p>
<ul>
<li>对于 <code>MInt&lt;M&gt;</code> 直接初始化了，不用在 setMod</li>
<li>对于 <code>ModInt, ModLL</code> 这些本来就要 setMod，那就给它调用 setMod 重新刷新 Binom 的值</li>
</ul>
<blockquote>
<p>源代码在换 mod 的时候会有 bug，于 2021-7-24 重构 Poly，通过继承 vector 方式而非 vector 变量的方式的时候发现了这个 bug 并修复了</p>
</blockquote>
<p><strong>注意事项</strong>：如果利用了 vector 这种结构，然后再用引用可能会因扩容而导致 RE，可以通过预先申请较大的内存的做法，此后不要随便用 <code>.back()</code> 这类不确定的调用</p>
<h4 id="lagrange"><a href="https://users.math.msu.edu/users/magyarp/Math880/Lagrange.pdf">Lagrange 反演</a></h4>
<p>若 <script type="math/tex">f(x), g(x) \in F[[x]]</script> 且 <script type="math/tex">f(g(x) = x</script>，则</p>
<p>
<script type="math/tex; mode=display">
[x^n] g(x) = \frac{1}{n} [x^{-1}] \frac{1}{f(x)^n}
</script>
</p>
<p>特别地，若 <script type="math/tex">f(x) = \frac{x}{\phi(x)}</script>，则</p>
<p>
<script type="math/tex; mode=display">
[x^n] g(x) = \frac{1}{n} [x^{n-1}] \phi(x)^n
</script>
</p>
<h3 id="_7">几何</h3>
<ul>
<li>二维凸包</li>
<li>旋转卡壳（彻底弄懂原理，之后应用此原理推广应用解决：https://www.luogu.com.cn/problem/P7164）</li>
<li>分治法求平面最短距离</li>
<li>k 维偏序之 bitset 暴力优化 <script type="math/tex">O(\frac{k n^2}{w})</script>
</li>
<li>四边形优化 DP</li>
</ul>
<h2 id="_8">图论</h2>
<ul>
<li>dfs 序</li>
<li>Euler 序</li>
<li>最近公共祖先 LCA</li>
<li>最小生成树 Prim</li>
<li>最小树形图 LiuZhu</li>
<li>拓扑排序</li>
<li>Euler 路</li>
<li>Hamilton 路？（NPC 问题，下次一定）</li>
<li>带路径 Floyd</li>
<li>最短路 Dijkstra</li>
<li>最短路 BellmaFord</li>
<li>最短路 SPFA</li>
<li>连通分量之 Kosaraju 缩点</li>
<li>连通分量之 2-SAT</li>
<li>割点割边</li>
<li>有向图 S-T 最大流 Dinic <script type="math/tex">O(n^2 m)</script>
</li>
<li>有向图 S-T 最大流的最高标号预流推进算法（HLPP） <script type="math/tex">O(n^2 \sqrt{m})</script> 算法</li>
<li>无向图全局最小割 StoerWagner 算法</li>
<li>最小费用最大流（势能 Dijkstra）</li>
<li>三元环计数</li>
</ul>
<h3 id="om-sqrtm">三元环计数上界 <script type="math/tex">O(m \sqrt{m})</script>
</h3>
<p>首先定向之后，每条边的出度不会超过 <script type="math/tex">\sqrt{m}</script>（妙啊），这是因为
- 原来不超过的必然不超过
- 原来超过的只会连度大于等于它的，这个个数不会超过 <script type="math/tex">\sqrt{m}</script>
</p>
<h2 id="_9">字符串</h2>
<ul>
<li>Trie 普通字符串版</li>
<li>Trie01 求两两异或最大值（可在线）</li>
<li>Trie01(FusionTree) 求异或和（支持修改，全局加 1）</li>
<li>前缀函数</li>
<li>基于前缀函数的 KMP 算法</li>
<li>基于前缀函数求前缀出现次数</li>
<li>Z-函数</li>
<li>基于 Z-函数的 KMP 算法</li>
<li>AC 自动机</li>
<li>后缀数组计算的 O(N) 诱导排序 SA-IS 算法</li>
<li>最小表示法</li>
<li>Lyndon 分解的 Duval 算法</li>
<li>处理回文的 Manacher 算法</li>
</ul>
<h2 id="_10">数据结构</h2>
<ul>
<li>暴力枚举</li>
<li>纠错码</li>
<li>离散化</li>
<li>并查集 (Disjoint Union Set)</li>
<li>树状数组 (FenwickTree)</li>
<li>线段树 (Segment Tree)</li>
<li>可持续化线段树(Persistable Segment Tree)</li>
<li>树状数组套线段树求动态区间第 k 小</li>
<li>莫队（线段树一样都是通用的类型，具体问题具体写）</li>
<li>最长（严格）递增子序列</li>
<li>单调队列</li>
<li>单调栈</li>
<li>笛卡尔树</li>
<li>三维偏序之陈丹琪分治</li>
<li>第二分块差值版（在线算法，离线可节省空间）</li>
<li>第二分块绝对值版（在线算法，可搞成带修改版本！）</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright © 2021 izlyforever</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
